IF (ASPELL_FOUND)
  INCLUDE_DIRECTORIES(
  ${CMAKE_SOURCE_DIR}
  ${CMAKE_SOURCE_DIR}/scribus
  ${ASPELL_INCLUDE_DIR}
  )

  SET(ASPELL_PLUGIN_UI_SRC
    aspellpluginbase.ui
#  donedlgbase.ui
  )

  SET(ASPELL_PLUGIN_MOC_CLASSES
    aspellplugin.h
    aspellpluginimpl.h
#  donedlgimpl.h
  )

  SET(ASPELL_PLUGIN_SOURCES
    aspellplugin.cpp
    aspellpluginimpl.cpp
#  donedlgimpl.cpp
    suggest.cpp
  )

IF (APPLEBUNDLE)
  #Setup the Aspell dictionary dir if making an APPLEBUNDLE
  SET(ASPELLRELATIVEDICTDIR "share/aspell/")
  ADD_DEFINITIONS("-DASPELLRELATIVEDICTDIR=\\\"${ASPELLRELATIVEDICTDIR}\\\"")
  MESSAGE(STATUS "Detected APPLEBUNDLE setting, adjust Aspell dictionary location, be sure to install dictionaries in: ${CMAKE_INSTALL_PREFIX}/${ASPELLRELATIVEDICTDIR}")
#Do not make this dir so we can detect it exists incode
# INSTALL(CODE "FILE(MAKE_DIRECTORY ${ENV}${CMAKE_INSTALL_PREFIX}/${ASPELLRELATIVEDICTDIR})")
ENDIF (APPLEBUNDLE)

  SET(SCRIBUS_ASPELL_PLUGIN "x_aspellplugin")

  QT4_WRAP_UI(ASPELL_PLUGIN_UI_SOURCES ${ASPELL_PLUGIN_UI_SRC} )
  QT4_WRAP_CPP(ASPELL_PLUGIN_MOC_SOURCES ${ASPELL_PLUGIN_MOC_CLASSES})

  ADD_LIBRARY(${SCRIBUS_ASPELL_PLUGIN} MODULE
    ${ASPELL_PLUGIN_SOURCES}
    ${ASPELL_PLUGIN_MOC_SOURCES}
    ${ASPELL_PLUGIN_UI_SOURCES}
  )

  TARGET_LINK_LIBRARIES(${SCRIBUS_ASPELL_PLUGIN} ${ASPELL_LIBRARIES} ${PLUGIN_LIBRARIES})

  INSTALL(TARGETS ${SCRIBUS_ASPELL_PLUGIN}
    LIBRARY
    DESTINATION ${PLUGINDIR}
    PERMISSIONS ${PLUGIN_PERMISSIONS}
  )

  ADD_DEPENDENCIES(${SCRIBUS_ASPELL_PLUGIN} ${EXE_NAME})

# SET_TARGET_PROPERTIES(${SCRIBUS_ASPELL_PLUGIN} PROPERTIES VERSION "0.0.1")
ENDIF (ASPELL_FOUND)


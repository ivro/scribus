<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<h2>Polices Ghostscript pour Linux, Unix et MacOSX.</h2>

<em>Merci &agrave; Craig Ringer et &agrave; Russell Lang, en charge de GSview.</em>

<p>Une des causes d'&eacute;chec du rendu/importation/conversion d'un fichier est lorsque Ghostscript n'arrive pas &agrave; localiser les polices n&eacute;cessaires pour afficher un EPS ou un PS. Il ne s'agit pas d'une lacune ou d'une d&eacute;faillance de Ghostscript, puisque <strong>tous</strong> les interpr&eacute;teurs EPS/PS ont besoin d'acc&eacute;der &agrave; la liste correcte des polices list&eacute;s dans le fichier PostScript. Ceci peut d&eacute;finitivement affecter les fichiers EPS/PS
que vous essayez d'importer dans Scribus. Certaines applications n'incluent pas correctement les polices, elles doivent donc &ecirc;tre fournies en externe. </p>

<p>Lorsque Ghostscript ne peut pas trouver une police, un message d'erreur de la console sera habituellement &eacute;mis comme suit :</p>

<pre>
  gs -h
  AFPL Ghostscript 8.50 (2004-12-10)
  Copyright (C) 2004 artofcode LLC, Benicia, CA.  All rights reserved.
bla bla bla...

invalidfont
Current allocation mode is local
Last OS error: No such file or directory
et ainsi de suite...
</pre>

<p>L'erreur <strong>invalidfont</strong> signifie a) : Ghostscript ne peut pas trouver la police ou les polices; b) : Ghostscript ne peut trouver<strong>aucune</strong> police; c) : il y a une police corrompue ou mal form&eacute;e sur votre syst&egrave;me.</p>

<p>La solution :</p>

<h4>Cr&eacute;er un fichier Fontmap </h4>

Il y a un secret dans la distribution source de GS, <pre>$GS_SRC_DIR/toolbin/genfontmap.ps</pre> Cette approche peut &ecirc;tre utilis&eacute;e pour g&eacute;n&eacute;rer un fichier Fontmap - les m&ecirc;mes fichiers o&ugrave; vous voyez ces redoutables scripts PERL sur Internet. Ce fichier peut &ecirc;tre livr&eacute; ou non avec votre distribution; donc, dans notre exemple, nous mentionnons le r&eacute;pertoire source "non-tarr&eacute;" pour construire une installation GS parall&egrave;le.
Vous devriez utiliser le <em>genfontmap.ps</em> de la version de Ghostscript que vous utilisez. Les autres fichiers pourraient ne pas fonctionner correctement. Voil&agrave; une autre bonne raison d'obtenir une version r&eacute;cente de Ghostscript.
<pre>
  
  $ gs -q -sFONTPATH=/usr/local/share/fonts/TrueType ${HOME}/build/ghostscript-8.31/toolbin/genfontmap.ps
  
  % This Fontmap generated by genfontmap.ps
  
  (AndaleMono)    (/usr/local/share/fonts/TrueType/AndaleMo.TTF) ;
  (Arial-Black)   (/usr/local/share/fonts/TrueType/AriBlk.TTF) ;
  (Arial-BoldItalicMT)    (/usr/local/share/fonts/TrueType/Arialbi.TTF) ;
  (Arial-BoldMT)  (/usr/local/share/fonts/TrueType/Arialbd.TTF) ;
  ... blah blah blah ...
  (Utopia-Regular)        (putr.pfa) ;
  (Verdana)       (/usr/local/share/fonts/TrueType/Verdana.TTF) ;
  (Verdana-Bold)  (/usr/local/share/fonts/TrueType/Verdanab.TTF) ;
  (Verdana-BoldItalic)    (/usr/local/share/fonts/TrueType/Verdanaz.TTF) ;
  (Verdana-Italic)        (/usr/local/share/fonts/TrueType/Verdanai.TTF) ;
  (Webdings)      (/usr/local/share/fonts/TrueType/Webdings.TTF) ;
  (ZapfChancery-MediumItalic)     /URWChanceryL-MediItal ;
  (ZapfDingbats)  /Dingbats ;
  
  genfontmap completed OK. 42 new fonts added.
  
</pre>

<p>Donc vous redirigez stdout ou copiez tout &agrave; partir de la ligne <code>% This Fontmap...</code> dans un &eacute;diteur de texte et sauvegardez le Fontmap, copiez le FontMap g&eacute;n&eacute;r&eacute; dans le r&eacute;pertoire font, puis ajoutez le r&eacute;pertoire &agrave; votre variable d'environnement GS_LIB :</p>

<p>Le chemin exact peut varier.</p>

<pre>
  $ gs -q -sFONTPATH=/usr/local/share/fonts/TrueType ${HOME}/build/ghostscript-8.50/toolbin/genfontmap.ps > /tmp/Fontmap
  $ sudo cp /tmp/Fontmap /usr/local/share/fonts/Truetype
  $ export GS_LIB=/usr/local/share/fonts/TrueType:$GS_LIB
  
</pre>

<p>Ensuite vous pouvez lancer Scribus &agrave; partir de la m&ecirc;me console et GS trouvera les polices et importera les fichiers EPS/PS sans probl&egrave;mes.</p>

<p>Alternativement, vous pouvez &eacute;diter votre lib/Fontmap GS &agrave; partir de la source ou ajouter les nouvelles entr&eacute;es fontmap &agrave; votre lib/Fontmap principal.</p>

<h4>Ajouter les polices TrueType suppl&eacute;mentaires de l'utilisateur</h4>

<p>En d&eacute;pit des efforts de la documentation de Ghostscript pour laisser entendre le contraire, les polices TrueType sont bien support&eacute;es dans Ghostscript et assez faciles &agrave; utiliser avec cet outil.</p>

<p>Encore mieux : la variable d'environnement GS_FONTPATH et l'argument -sFONTPATH peuvent sp&eacute;cifier des r&eacute;pertoires contenant toute police support&eacute;e, en sus des polices PostScript mentionn&eacute;es dans la documentation.</p>

<pre>$ export GS_FONTPATH=$MY_FONT_DIR:$HOME/.fonts
$ scribus</pre>

<h4>Polices Ghostscript et importation EPS</h4>

<p>L'importation EPS dans Scribus est affect&eacute;e par le chemin de police de Ghostscript. Si GS ne peut pas trouver les polices, elles seront substitu&eacute;es sans signal particulier. L'id&eacute;e est de permettre &agrave; GS de trouver vos polices.</p>

<p>Il est recommand&eacute; de cr&eacute;er les fichiers Fontmap pour vos r&eacute;pertoires de polices, puis de les ajouter &agrave; la variable d'environnement GS_LIB, ce qui permettra &agrave; GS de charger les polices plus rapidement dans le futur.
Les tests confirment qu'une fois que GS sait o&ugrave; trouver les polices, l'importation EPS dans Scribus choisit heureusement les polices parmi celles disponibles localement lorsqu'il y a une correspondance avec une police requise par l'EPS, mais qui n'est pas incluse.</p>

<p>Notez que dans tout ce qui pr&eacute;c&egrave;de, la cr&eacute;ation et la mise &agrave; jour de Fontmap.gs est habituellement fait automagicalement, en utilisant Kfontinstaller, comme mentionn&eacute; ici : <a href="fonts2.html" name="Font Installation with KDE">Installation des polices avec KDE</a></p>

</body>
</html> 